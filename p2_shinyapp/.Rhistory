(Schizophrenia, Schizoaffective, etc)"),
`Eating Disorder` = sum(`Eating Disorder` == "Eating Disorder
(Anorexia, Bulimia, etc)")
View(disorder_by_state)
View(disorder_by_state)
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder
(Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder
(Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder
(Schizophrenia, Schizoaffective, etc)"),
`Eating Disorder` = sum(`Eating Disorder` == "Eating Disorder
(Anorexia, Bulimia, etc)")
View(disorder_by_state)
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder
(Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder
(Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder
(Schizophrenia, Schizoaffective, etc)"),
`Eating Disorder` = sum(`Eating Disorder` == "Eating Disorder
(Anorexia, Bulimia, etc)")
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder
(Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder
(Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder
(Schizophrenia, Schizoaffective, etc)")
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder
(Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder
(Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder
(Schizophrenia, Schizoaffective, etc)")
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder
(Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder
(Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder
(Schizophrenia, Schizoaffective, etc)")
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder
(Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder
(Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder
(Schizophrenia, Schizoaffective, etc)")
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder
(Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder
(Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder
(Schizophrenia, Schizoaffective, etc)")
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder
(Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder
(Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder
(Schizophrenia, Schizoaffective, etc)")
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder
(Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder
(Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder
(Schizophrenia, Schizoaffective, etc)")
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder
(Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder
(Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder
(Schizophrenia, Schizoaffective, etc)")
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder
(Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder
(Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder
(Schizophrenia, Schizoaffective, etc)")
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder
(Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder
(Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder
(Schizophrenia, Schizoaffective, etc)")
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder
(Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder
(Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder
(Schizophrenia, Schizoaffective, etc)")
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder
(Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder
(Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder
(Schizophrenia, Schizoaffective, etc)")
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder
(Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder
(Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder
(Schizophrenia, Schizoaffective, etc)")
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder (Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder (Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder (Schizophrenia, Schizoaffective, etc)")
#   `Eating Disorder` = sum(`Eating Disorder` == "Eating Disorder
#                         (Anorexia, Bulimia, etc)")
)
disorder_by_state <- osmi_df %>%
group_by(state) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder (Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder (Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder (Schizophrenia, Schizoaffective, etc)")
#   `Eating Disorder` = sum(`Eating Disorder` == "Eating Disorder
#                         (Anorexia, Bulimia, etc)")
)
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder (Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder (Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder (Schizophrenia, Schizoaffective, etc)")
#   `Eating Disorder` = sum(`Eating Disorder` == "Eating Disorder
#                         (Anorexia, Bulimia, etc)")
)
source('~/Documents/Github/INFO201_Final/AE_TeamWellness/p2_shinyapp/analysis.R', echo=TRUE)
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder (Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder (Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder (Schizophrenia, Schizoaffective, etc)")
#   `Eating Disorder` = sum(`Eating Disorder` == "Eating Disorder
#                         (Anorexia, Bulimia, etc)")
)
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder (Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder (Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder (Schizophrenia, Schizoaffective, etc)")
`Eating Disorder` = sum(`Eating Disorder` == "Eating Disorder (Anorexia, Bulimia, etc)")
)
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` == "Anxiety Disorder (Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` == "Mood Disorder (Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` == "Psychotic Disorder (Schizophrenia, Schizoaffective, etc)"),
`Eating Disorder` = sum(`Eating Disorder` == "Eating Disorder (Anorexia, Bulimia, etc)")
)
View(disorder_by_state)
disorder_by_state <- osmi_df %>%
group_by(State) %>%
summarise(`Anxiety Disorder` = sum(`Anxiety Disorder` ==
"Anxiety Disorder (Generalized, Social, Phobia, etc)"),
`Mood Disorder` = sum(`Mood Disorder` ==
"Mood Disorder (Depression, Bipolar Disorder, etc)"),
`Psychotic Disorder` = sum(`Psychotic Disorder` ==
"Psychotic Disorder (Schizophrenia, Schizoaffective, etc)"),
`Eating Disorder` = sum(`Eating Disorder` ==
"Eating Disorder (Anorexia, Bulimia, etc)"),
`Attenion Deficit Hyperactivity Disorder` = sum(`Attenion Deficit Hyperactivity Disorder` ==
"Attention Deficit Hyperactivity Disorder"),
`Personality Disorder` = sum(`Personality Disorder` ==
"Personality Disorder (Borderline, Antisocial, Paranoid, etc)"),
`Obsessive Compulsive Disorder` = sum(`Obsessive Compulsive Disorder` ==
"Obsessive-Compulsive Disorder"),
`Post Traumatic Stress Disorder` = sum(`Post Traumatic Stress Disorder` ==
"Post-traumatic Stress Disorder"),
`Stress Response Disorder` = sum(`Stress Response Disorder` ==
"Stress Response Syndromes"),
`Dissociative Disorder` = sum(`Dissociative Disorder` ==
"Dissociative Disorder"),
`Substance Use Disorder` = sum(`Substance Use Disorder` ==
"Substance Use Disorder"),
`Addictive Disorder` = sum(`Addictive Disorder` ==
"Addictive Disorder")
)
View(disorder_by_state)
install.packages("melt")
install.packages("reshape2")
library(reshape2)
View(disorder_by_state)
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = State)
return_plot <- ggplot(subset(return_plot_data_m, State == "Washington"), aes(x = variable, y = value)) +
geom_bar(stat = "identity")
}
get_state_disorders("Washington")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = given_state)
return_plot <- ggplot(subset(return_plot_data_m, State == "Washington"), aes(x = variable, y = value)) +
geom_bar(stat = "identity")
}
get_state_disorders("Washington")
View(disorder_by_state)
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == "Washington"), aes(x = variable, y = value)) +
geom_bar(stat = "identity")
}
get_state_disorders("Texas")
test <- get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == "Washington"), aes(x = variable, y = value)) +
geom_bar(stat = "identity")
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == "Washington"), aes(x = variable, y = value)) +
geom_bar(stat = "identity")
return_plot_data_m
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity")
return_plot_data_m
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity")
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity") +
labs(x = "Disorders", y = "# of People")
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state))
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(width = 0.4, stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state))
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(width = 2, stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state))
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state)) +
theme(legend.position = "botton",
legend.spacing.x = unit(1.0, "cm"))
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state)) +
theme(legend.position = "botton",
legend.spacing.x = unit(2.0, "cm"))
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state)) +
theme(legend.position = "bottom",
legend.spacing.x = unit(2.0, "cm"))
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state)) +
theme(legend.position = "bottom",
legend.spacing.x = unit(5.0, "cm"))
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state)) +
theme(legend.position = "top",
legend.spacing.x = unit(5.0, "cm"))
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state)) +
guides(fill=guide_legend(
keywidth=0.1,
keyheight=0.1,
default.unit="inch")
)
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state)) +
guides(fill=guide_legend(
keywidth=2.1,
keyheight=0.1,
default.unit="inch")
)
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state))
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state)) +
theme(legend.text = element_text(
margin = margin(r = 30, unit = "pt")))
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state)) +
theme(axis.text.x = element_text(hjust = 5))
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state)) +
theme(axis.text.x = element_text(hjust = 1))
return_plot
}
get_state_disorders("Texas")
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state)) +
scale_x_discrete(labels = wrap_format(10))
return_plot
}
get_state_disorders("Texas")
install.packages("scales")
install.packages("scales")
install.packages("scales")
install.packages("scales")
library(scales)
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state)) +
scale_x_discrete(labels = wrap_format(10))
return_plot
}
get_state_disorders("Texas")
library(dplyr)
library(ggplot2)
library(plotly)
library(knitr)
library(leaflet)
library(tigris)
library(reshape2)
get_state_disorders <- function(given_state){
return_plot_data <- disorder_by_state %>%
filter(State == given_state)
return_plot_data_m <- melt(return_plot_data, id.vars = "State")
return_plot <- ggplot(subset(return_plot_data_m, State == given_state), aes(x = variable, y = value)) +
geom_bar(stat = "identity") +
labs(x = "Disorders", y = "# of People") +
ggtitle(paste("# of People Affected by a Specific Disorder in", given_state)) +
scale_x_discrete(labels = wrap_format(10))
return_plot
}
get_state_disorders("Texas")
help(wrap_format)
library(scales)
library(ggplot2)
